# SeedSearch 設計ドキュメント

福岡工業大学が持つ研究シーズを検索するシステム

> 「研究シーズ」とは、将来的に製品やサービスに発展する可能性を秘めた「技術の種」のこと

## 1. プロジェクト概要

### 1.1 目的
- **学内**の研究シーズの効率的な検索とアクセスを可能にする
- 学生と研究者、研究者同士のマッチングを支援する
- 学内の研究活動の可視化と分析を行う
- 学際的な共同研究や学生の研究活動を促進する

### 1.2 なぜ必要なのか
福岡工業大学内で「**誰がどんな研究をしているのか**」を簡単に見つけられるようにすることで、学生の研究活動支援、学際的な共同研究の促進、研究成果の社会還元を実現する。

### 1.3 主要ユーザーとユースケース

> **注**: 以下の利用シーンは、システムの想定ユースケースを示す例です。実際のデータ内容とは異なる場合があります。

#### 1.3.1 学生（主要ユーザー）

**利用シーン1: 卒業研究のテーマ探し**
```
状況: 「IoTとセンサー技術」に興味があり、関連する研究室を探したい
操作: seedsearch search "IoT センサー"
結果: 関連研究をしている教授・研究室を発見
→ 研究室訪問のアポを取り、卒業研究のテーマを相談
```

**利用シーン2: 課題で困った時の相談先探し**
```
状況: 画像認識の課題で行き詰まり、詳しい先生を探したい
操作: seedsearch search "画像認識" --field keyword
結果: 該当分野の専門家を発見
→ オフィスアワーや研究室訪問で質問・相談
```

**利用シーン3: プロジェクト活動での協力者探し**
```
状況: 学生プロジェクトで「ロボット制御」の知見を持つ人を探したい
操作: seedsearch search "ロボット"
結果: 関連する研究室や研究者を発見
→ 共同研究やコラボレーションを提案
```

**利用シーン4: 研究室配属の意思決定** 未完成
```
状況: 配属先を決めるため、各研究室の研究内容を比較したい
操作: seedsearch search "AI" --output csv
結果: AI関連の研究室リストをExcelで比較検討
→ 配属希望先を決定
```

#### 1.3.2 研究者・教授（主要ユーザー）

**利用シーン1: 学内共同研究相手の発見**
```
状況: バイオ研究にデータ分析の専門家を加えたい
操作: seedsearch search "データ分析" --field researcher
結果: 学内の異分野研究者を発見
→ 学際的な共同研究プロジェクトを立ち上げ
```

**利用シーン2: 学生への専門家紹介**
```
状況: 学生の質問が自分の専門外で、適切な先生を紹介したい
操作: seedsearch search "量子コンピュータ"
結果: 該当分野の研究者を発見
→ 学生に紹介
```

#### 1.3.3 産学連携コーディネーター（副次的ユーザー）

**利用シーン: 企業からの技術相談対応**
```
状況: 企業から「AI を使った製造業の品質管理」の相談
操作: seedsearch search "AI 製造" --output json
結果: 該当する研究者のリストを取得
→ 企業と研究者のマッチング
```

## 2. データソースとスキーマ

### 2.1 データソース
- **取得元**: KAKEN（科学研究費助成事業データベース）
- **対象**: 福岡工業大学所属の研究者が関わる研究課題
- **形式**: CSV
- **更新頻度**: 手動更新（不定期）

### 2.2 データスキーマ

KAKENのCSVデータには以下の主要フィールドが含まれる：

| フィールド名 | 説明 | 検索対象 | 表示優先度 |
|------------|------|---------|----------|
| 研究課題名 | 研究のタイトル（日本語） | ✓ | 高 |
| 研究課題名（英文） | 研究のタイトル（英語） | ✓ | 中 |
| 研究課題/領域番号 | 課題番号 | - | 高 |
| 研究期間 | 研究実施期間 | - | 中 |
| **研究代表者** | **代表研究者名と所属** | **✓** | **最高** |
| **研究分担者** | **分担研究者名と所属** | **✓** | **高** |
| キーワード | 研究キーワード | ✓ | 高 |
| 研究分野 | 研究分野分類 | ✓ | 中 |
| 審査区分 | 科研費の審査区分 | - | 低 |
| 研究種目 | 基盤研究(C)等の種目 | - | 低 |
| 研究機関 | 所属機関名 | - | 中 |
| 研究開始時の研究の概要 | 研究開始時の概要 | ✓ | 低 |
| 研究概要 | 研究の概要（日本語） | ✓ | 高 |
| 研究概要（英文） | 研究の概要（英語） | ✓ | 中 |

### 2.3 研究者情報の取り扱い（重要）

学内ユーザー向けに、以下の研究者情報を**重点的に表示**する：

#### 2.3.1 研究代表者フィールドの解析
KAKENの「研究代表者」フィールドには以下の情報が含まれる：
```
例: 東 隼也（福岡工業大学・工学部・教授）
```

以下の情報を抽出・表示する：
- **氏名**: 東 隼也
- **所属機関**: 福岡工業大学
- **所属学部**: 工学部
- **職位**: 教授

#### 2.3.2 データの制約と将来拡張

**現在のKAKENデータには含まれない情報**（将来的に別データソースから補完を検討）：
- 研究室の場所（建物・部屋番号）
- メールアドレス
- 電話番号
- 研究室Webサイト
- オフィスアワー
- 受け入れ可能な学生数
- 現在進行中のプロジェクト詳細

**対応方針**：
- Phase 1では**KAKENデータのみ**を使用し、研究者名・所属・研究内容で検索可能にする
- Phase 4以降で、学内の教員データベースや研究室Webサイトと統合して詳細情報を提供

## 3. 機能要件

### 3.1 検索機能

#### 3.1.1 キーワード検索
- **完全一致検索**: 指定したキーワードと完全に一致する研究を検索
- **部分一致検索**: キーワードを含む研究を検索（デフォルト）
- **複数ワード検索**: スペース区切りで複数キーワードを指定可能（OR検索）
  - 例: `seedsearch search "IoT センサー"` → IoTまたはセンサーを含む研究を検索
- **検索対象フィールド**:
  - 研究課題名（日英）
  - キーワード
  - 研究概要（日英）
  - 研究者名

#### 3.1.2 検索オプション
ユーザーは以下の方法で検索条件を指定できる：

**1. コマンドラインオプション方式**
```bash
seedsearch search "AI" --exact  # 完全一致
seedsearch search "AI" --field keyword  # 特定フィールドのみ検索
seedsearch search "ロボット" --output json  # JSON形式で出力
```

**2. 対話形式**
```bash
seedsearch interactive
> 検索ワードを入力: AI
> 検索モードを選択 [1: 部分一致, 2: 完全一致]: 1
> 検索対象フィールド [全て/タイトル/キーワード/概要]: 全て
```

#### 3.1.3 類似検索（将来実装）
- ベクトルDBを使用した意味的類似検索
- 入力クエリに類似する研究を推薦

### 3.2 表示機能

#### 3.2.1 検索結果リスト表示
```
検索結果: 15件

1. [25KJ2239] Beyond 5G/6Gにおける信頼性のための知的プラットフォームの実装と評価
   研究代表者: 東 隼也（福岡工業大学）
   キーワード: AI, ネットワーク, 信頼性

2. [25K14659] 車いすテニスやバドミントンを促進するマシンスポーツの提案
   研究代表者: 松尾 慶太（福岡工業大学）
   キーワード: 車いすテニス, 障がい者スポーツ
```

#### 3.2.2 詳細表示
```bash
seedsearch show 25KJ2239
```

研究課題の全情報を表示

### 3.3 出力形式
- **テーブル形式**: デフォルト（ターミナル上での表示）
- **JSON形式**: `--output json` オプションで機械可読形式
- **CSV形式**: `--output csv` オプションでExcel等での利用

## 4. 技術スタック

### 4.1 言語・フレームワーク
- **Python 3.11+**
- **CLIフレームワーク**: Click または Typer（検討中）
- **パッケージ管理**: uv

### 4.2 データ処理
- **CSVパース**: pandas
- **データ検索**: pandas + 正規表現
- **将来（類似検索）**:
  - ベクトルDB: Chroma / Qdrant
  - 埋め込みモデル: OpenAI / sentence-transformers

### 4.3 出力整形
- **テーブル表示**: rich / tabulate
- **カラー表示**: rich

## 5. アーキテクチャ設計

### 5.1 ディレクトリ構造
```
SeedSearch/
├── src/
│   └── seedsearch/
│       ├── __init__.py
│       ├── cli.py          # CLIエントリーポイント
│       ├── search.py       # 検索ロジック
│       ├── loader.py       # CSVデータローダー
│       ├── display.py      # 結果表示
│       └── models.py       # データモデル
├── data/
│   └── kaken.csv          # KAKENデータ（gitignore）
├── tests/
│   └── test_search.py
├── docs/
│   └── designdocs.md
├── main.py
├── pyproject.toml
└── README.md
```

### 5.2 データフロー
```
CSV読み込み → DataFrameに変換 → 検索実行 → 結果整形 → 表示
```

### 5.3 モジュール設計

#### loader.py
- CSVファイルの読み込み
- DataFrameへの変換
- データのバリデーション

#### search.py
- キーワード検索ロジック（完全一致・部分一致）
- フィールド指定検索
- 検索結果のフィルタリング

#### display.py
- 検索結果の整形
- テーブル/JSON/CSV形式への変換
- richを使った美しい表示

#### cli.py
- コマンドライン引数のパース
- 対話形式UIの実装
- 各コマンドの実装

#### models.py
- ResearchProjectクラス（研究課題のデータモデル）
- 型定義（TypedDict等）

## 6. 非機能要件

### 6.1 パフォーマンス
- CSV読み込み時間: < 1秒（数千件のデータ想定）
- 検索応答時間: < 0.5秒

### 6.2 ユーザビリティ
- 直感的なCLIインターフェース
- ヘルプメッセージの充実
- エラーメッセージの分かりやすさ

### 6.3 保守性
- 単体テストのカバレッジ > 80%
- 型ヒントの使用
- ドキュメントの整備

## 7. 開発フェーズ

### Phase 1: 基本検索機能（MVP）✅ 完了
- [x] CSVデータの読み込み機能
- [x] 部分一致検索の実装
- [x] 基本的な結果表示（シンプルなテキスト出力）
- [x] CLIインターフェース構築（searchコマンド）

### Phase 2: 検索機能の拡張 ✅ 完了
- [x] 完全一致検索オプション
- [x] フィールド指定検索
- [x] 複数ワード検索（OR検索）
- [ ] 対話形式UI（interactiveコマンド）
- [x] 詳細表示機能（showコマンド）

### Phase 3: 出力形式の拡充 🚧 一部完了
- [x] JSON出力機能
- [x] CSV出力機能
- [x] リッチな表示（色付け、キーワードハイライト）
- [ ] テーブル整形（rich/tabulateライブラリ使用）
- [ ] ページング機能

### Phase 4: 類似検索（将来）
- [ ] ベクトルDB導入（Chroma/Qdrant）
- [ ] 埋め込みモデル統合
- [ ] 意味的類似検索の実装
- [ ] 推薦機能

## 8. コマンド仕様

### 8.1 基本コマンド

```bash
# 基本検索
seedsearch search "キーワード"

# 複数ワード検索（OR検索）
seedsearch search "IoT センサー"
seedsearch search "AI ロボット"

# 完全一致検索
seedsearch search "AI" --exact

# フィールド指定検索
seedsearch search "ロボット" --field keyword
seedsearch search "松尾" --field researcher

# 複数ワード + フィールド指定
seedsearch search "IoT センサー" --field keyword

# 出力形式指定
seedsearch search "AI" --output json
seedsearch search "AI" --output csv
seedsearch search "IoT センサー" --output json

# 詳細表示
seedsearch show 25KJ2239

# 対話形式（未実装）
seedsearch interactive

# ヘルプ
seedsearch --help
seedsearch search --help
```

### 8.2 オプション一覧

| オプション | 短縮形 | 説明 | デフォルト |
|----------|--------|------|----------|
| --exact | -e | 完全一致検索 | False |
| --field | -f | 検索対象フィールド指定 | all |
| --output | -o | 出力形式（table/json/csv） | table |
| --limit | -l | 表示件数の制限 | 全件 |
| --help | -h | ヘルプ表示 | - |

## 9. エラーハンドリング

### 9.1 想定されるエラー
- CSVファイルが見つからない
- CSVファイルのフォーマットが不正
- 検索結果が0件
- 無効なコマンドオプション

### 9.2 エラーメッセージ例
```
エラー: データファイルが見つかりません
→ data/kaken.csv を配置してください

警告: 検索結果が見つかりませんでした
→ 検索ワードを変更してみてください

エラー: 無効な出力形式です
→ --output には table, json, csv のいずれかを指定してください
```

## 10. テスト戦略

### 10.1 単体テスト
- loader.pyのCSV読み込み機能
- search.pyの検索ロジック
- display.pyの出力整形機能

### 10.2 統合テスト
- CLIコマンドの実行テスト
- エンドツーエンドの検索フロー

### 10.3 テストデータ
- サンプルCSVファイルの作成
- 各種検索パターンのテストケース

## 11. 将来の展望
- AIを活用した研究シーズの推薦機能
- Web UIの開発
- 多言語対応（英語インターフェース）
- 自動データ更新機能（KAKENからのスクレイピング）
- 研究者ネットワークの可視化
- 研究分野のトレンド分析
